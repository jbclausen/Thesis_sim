import numpy as np
import matplotlib.pyplot as plt 
from scipy.optimize import curve_fit

def func(x, a, b, c):
    return a * np.exp(-b * x) + c

final_h = 0.021921776098478264
steps = [0.0002850255779418588, 0.00030963455522791273, 0.00024744073793901006, 0.00014650343597047335, 0.00017867955190232349, 0.00021616101934106985, 0.0001711240570153906, 0.00013542579373847057, 0.00013117885716768755, 0.0001473374096350403, 0.00016970850884594733, 0.00014635570197790975, 0.0001403769206922154, 0.00013497250495850786, 0.00013950008479837218, 0.00014055866123484275, 0.00013234830081327014, 0.00011444232482852451, 0.00011579325283758192, 0.00011299021107273946, 0.00010609403136166776, 0.00010134843779554051, 9.745170379466504e-05, 9.904914285972961e-05, 0.00010326961094664008, 0.00010068017582252724, 9.873462823360712e-05, 0.0001014633373287565, 0.00010004141482125237, 0.00010195813942170083, 9.804830392542117e-05, 9.64190135902699e-05, 9.249738666516037e-05, 9.32221495363976e-05, 8.862019663178136e-05, 8.852196127851278e-05, 8.38981750901132e-05, 8.466550366396756e-05, 8.18276082662963e-05, 8.094135265925007e-05, 8.331584084673993e-05, 8.11058649620236e-05, 7.919336302617853e-05, 7.751316936984408e-05, 7.820221950838487e-05, 7.893306354247315e-05, 8.076817830525267e-05, 7.901461013768048e-05, 8.178500828154647e-05, 8.111775638677127e-05, 7.919541213726594e-05, 7.991409926170687e-05, 8.100431769271325e-05, 7.83176065436951e-05, 7.993394505917753e-05, 7.986572174036206e-05, 7.962800455544629e-05, 7.83469215045289e-05, 7.743972000879944e-05, 7.74564864419354e-05, 7.559895895385867e-05, 7.535809296691648e-05, 7.46277515921677e-05, 7.541514882893237e-05, 7.300035433225639e-05, 7.294739647379159e-05, 7.156771145770506e-05, 7.16587832882195e-05, 7.135889344557673e-05, 7.054693779846334e-05, 6.945287485567858e-05, 6.821110828229664e-05, 6.675877088008729e-05, 6.614196840778672e-05, 6.503532725611431e-05, 6.46860672939651e-05, 6.420429367803848e-05, 6.306831828586067e-05, 6.287939995707446e-05, 6.2195899203768e-05, 6.281351662651598e-05, 6.221378904827483e-05, 6.132173494387272e-05, 6.031549450243902e-05, 5.9891775991886484e-05, 6.0198911930398405e-05, 5.999290106427704e-05, 5.9976404798907715e-05, 5.97667447511923e-05, 5.933135348048374e-05, 5.833036091553931e-05, 5.812039973612272e-05, 5.8110160471951805e-05, 5.8158064827574726e-05, 5.778935063435742e-05, 5.753254175469742e-05, 5.7072832508558644e-05, 5.655778187516232e-05, 5.615970474283534e-05, 5.59605131850386e-05, 5.569551361871844e-05, 5.5154178857888536e-05, 5.485944532727417e-05, 5.481832569851838e-05, 5.397134576486454e-05, 5.3566057411112006e-05, 5.358390477957012e-05, 5.372461795922871e-05, 5.357034978663126e-05, 5.369012776645053e-05, 5.370775103866535e-05, 5.3419248590284504e-05, 5.381925789762522e-05, 5.333083313660385e-05, 5.310384989258045e-05, 5.279763055216456e-05, 5.229531339227475e-05, 5.210413029544357e-05, 5.1919518399865666e-05, 5.10755344016664e-05, 5.107258409044364e-05, 5.083448985504849e-05, 5.042015448775486e-05, 5.0143838907898766e-05, 5.000399571845893e-05, 4.928878369126616e-05, 4.931745690044467e-05, 4.8815391242691686e-05, 4.9001430543666596e-05, 4.8823095837825445e-05, 4.8786363116115616e-05, 4.8599292004555816e-05, 4.8415838187754884e-05, 4.81658755075616e-05, 4.829968305011985e-05, 4.8209441637062436e-05, 4.7833441865296686e-05, 4.754344463706907e-05, 4.795033864983707e-05, 4.774543228929298e-05, 4.784832435681882e-05, 4.794374030316767e-05, 4.7843175296529566e-05, 4.736531427807292e-05, 4.737019506394907e-05, 4.708927219535322e-05, 4.672252103736507e-05, 4.647443168253468e-05, 4.626755904259608e-05, 4.630432284261771e-05, 4.603923807177529e-05, 4.5975997893236975e-05, 4.566345569010852e-05, 4.5546406725129746e-05, 4.5568558506330764e-05, 4.6019848928914586e-05, 4.596044528037621e-05, 4.5968321384537436e-05, 4.601634843065874e-05, 4.593645379292674e-05, 4.616759212310029e-05, 4.602630022157092e-05, 4.602824419961543e-05, 4.61452169238305e-05, 4.5932548888807934e-05, 4.591763248756181e-05, 4.578466671364273e-05, 4.565721324622726e-05, 4.538898969692895e-05, 4.5348626969164696e-05, 4.5234634134465324e-05, 4.5128301684561195e-05, 4.4875993763401206e-05, 4.4825518972332196e-05, 4.4551982075008434e-05, 4.4508021270033005e-05, 4.439179837831958e-05, 4.4300001833336156e-05, 4.430357840999252e-05, 4.432424135533686e-05, 4.432476618508249e-05, 4.417298934140251e-05, 4.4261632381158156e-05, 4.403897635962481e-05, 4.393906117879445e-05, 4.380529019725604e-05, 4.36774504424392e-05, 4.336109430071872e-05, 4.343731388364164e-05, 4.3366443223738504e-05, 4.325132232793974e-05, 4.3250614759095946e-05, 4.297042862043757e-05, 4.2768238231297856e-05, 4.2747405279611184e-05, 4.268865996755189e-05, 4.2404832039582424e-05, 4.2355376108627746e-05, 4.22446211020798e-05, 4.218057607498216e-05, 4.211559973603743e-05, 4.186728570437434e-05, 4.164242567987128e-05, 4.144474412700119e-05, 4.116806958077979e-05, 4.1138238323371046e-05, 4.098470909493293e-05, 4.0729231012281986e-05, 4.0806694329379584e-05, 4.0525414451385994e-05, 4.033953365711884e-05, 4.0076231462984196e-05, 3.996597460917406e-05, 3.968522619391887e-05, 3.945371251212401e-05, 3.946478281939905e-05, 3.934862429592553e-05, 3.920020394027751e-05, 3.907461332750342e-05, 3.897581072436623e-05, 3.8889933961162165e-05, 3.861829718135312e-05, 3.837318580798485e-05, 3.812780187156112e-05, 3.8075809459497956e-05, 3.796377545276994e-05, 3.7775240946051614e-05, 3.7680635817435165e-05, 3.757149727211251e-05, 3.740377638997844e-05, 3.729180200294155e-05, 3.730099616493232e-05, 3.73493535972616e-05, 3.7279838863275155e-05, 3.7281264267542e-05, 3.715519360958722e-05, 3.702560761971799e-05, 3.681338597351369e-05, 3.674421521779672e-05, 3.6646299715371866e-05, 3.653449516407767e-05, 3.6220286429706344e-05, 3.620284266427076e-05, 3.603780963343933e-05, 3.5902892898679456e-05, 3.573764879332558e-05, 3.5640511477787185e-05, 3.560205364110808e-05, 3.557055077093793e-05, 3.5532843727738295e-05, 3.5492596185057734e-05, 3.548739056876554e-05, 3.54143264000642e-05, 3.5348480585145614e-05, 3.531979975129537e-05, 3.5259456486445157e-05, 3.514411587896352e-05, 3.5054815593842104e-05, 3.492786797078262e-05, 3.471343742580263e-05, 3.469215261009753e-05, 3.458616231118844e-05, 3.454925615144211e-05, 3.4520652032136306e-05, 3.4347788196813916e-05, 3.431715498605076e-05, 3.422826865956061e-05, 3.4169997547007364e-05, 3.410781524191067e-05, 3.3953737198919726e-05, 3.397068779827095e-05, 3.390554848314159e-05, 3.387483488194107e-05, 3.380042384877255e-05, 3.3714290429052995e-05, 3.36447400436056e-05, 3.3602365715409976e-05, 3.3655962043153964e-05, 3.3596734453973653e-05, 3.354815079683465e-05, 3.351109222756235e-05, 3.341376924216252e-05, 3.335718445081348e-05, 3.3301766849892084e-05, 3.3272121841110974e-05, 3.323408396083832e-05, 3.310286864299447e-05, 3.30246917366675e-05, 3.30290555384527e-05, 3.297802383986706e-05, 3.284441209034511e-05, 3.2820364672760116e-05, 3.2783372584534176e-05, 3.275953297453629e-05, 3.261262728711592e-05, 3.260695756939283e-05, 3.243129729303684e-05, 3.2337801751613354e-05, 3.232998979413662e-05, 3.2287446440220496e-05, 3.225277652316519e-05]
steps = [-0.008539999999999999, -0.008135468679356647, -0.007856337540108334, -0.007624087622683148, -0.007453663902765604, -0.0072736249988815905, -0.007094015253572689, -0.006925810406535153, -0.006765065886110101, -0.006610117024262039, -0.006438957389938462, -0.006261530918305638, -0.006074754582970653, -0.005913991875352175, -0.005759679762806881, -0.005610792004278623, -0.005470003511213722, -0.00532606716103381, -0.0051900640995866465, -0.005056430153316846, -0.004928305844033779, -0.004799588048284062, -0.004674745046010476, -0.004555220705637832, -0.004444575981783959, -0.004333286124411853, -0.004220759170874576, -0.0041099048956631775, -0.004001698390793457, -0.0038969266690467306, -0.0037929269764501758, -0.0036893567683091238, -0.003585953924232303, -0.003484349243219855, -0.003384500720344734, -0.003282462831639772, -0.003182049954016821, -0.003084951314054876, -0.0029876378773558325, -0.002891351230327579, -0.002798237730764828, -0.002705591635250605, -0.002614509339059155, -0.0025236539668005865, -0.002433078951421505, -0.002342016876322066, -0.0022511427014152274, -0.002161730649964807, -0.002074465371252327, -0.001988340828227616, -0.0019019167477471362, -0.0018172372870440027, -0.0017347733730688555, -0.0016520941794732399, -0.0015697322819380258, -0.0014883058232057114, -0.0014069488573717403, -0.0013279725568279208, -0.0012500896969057198, -0.0011732984517148785, -0.0010978071516781103, -0.001024338148362925, -0.0009515795835498053, -0.000879362058083787, -0.0008067990241701614, -0.0007349595188276156, -0.0006636619185846974, -0.0005923048290853829, -0.000522774108632086, -0.00045416679697411093, -0.0003863060557050696, -0.0003193865783566038, -0.00025257324156834364, -0.0001870208157249148, -0.00012131726614590217, -5.632015840999572e-05, 9.016561620862388e-06, 7.473440936089202e-05, 0.00014071121816996594, 0.00020675115416954418, 0.00027274383281521576, 0.00033875574869232807, 0.00040434189914177407, 0.00046902798558662155, 0.0005336432186858897, 0.0005976131957745092, 0.0006605850863756482, 0.0007228943617046456, 0.000784753225845452, 0.000846285040727482, 0.0009070081616048515, 0.0009672361459610959, 0.0010271887252682862, 0.0010866976107884927, 0.001146219222297514, 0.0012050857073640832, 0.001263528756405382, 0.0013207936511052257, 0.0013776522858851355, 0.0014342114996494643, 0.0014904307665246919, 0.0015466331228148062, 0.0016022883772096072, 0.0016577070081315588, 0.0017126834155138857, 0.0017672234389724468, 0.001821731846151955, 0.001876020617242736, 0.001929987147453182, 0.001983898256128461, 0.0020375344215676217, 0.002090958033097332, 0.0021440186626879854, 0.002196929946170002, 0.002249500219655381, 0.002301966416077544, 0.002354203204068746, 0.0024064636974189895, 0.0024583369726416124, 0.002510054312615081, 0.002561285116481098, 0.002612242636932306, 0.002662969317144315, 0.0027134235368489468, 0.0027637380893413225, 0.0028139443029291094, 0.0028640295275463557, 0.0029137684761357083, 0.0029635361835699723, 0.0030130477277899, 0.0030623749503644873, 0.003111489646115419, 0.003160445524984185, 0.0032095513521756673, 0.003258569952119542, 0.00330751445446832, 0.0033561295603392626, 0.0034044494143210847, 0.003452661879913174, 0.0035007598525165218, 0.003548628375615934, 0.0035963004575469246, 0.0036439393565965155, 0.003691233246114127, 0.0037383199763117475, 0.0037854185283906737, 0.0038322106994545164, 0.0038790675430408904, 0.003925775986099098, 0.003972468017697376, 0.004019107455772684, 0.004065571105266007, 0.004111927975253863, 0.004158237564401702, 0.004204309695949001, 0.004250302217182497, 0.004296101684115698, 0.004341896846617527, 0.004387541477246394, 0.004433080655896855, 0.004478455714485846, 0.004523590638553871, 0.004568485134406193, 0.004613143187484967, 0.004657620945786671, 0.004702093102278927, 0.004746312626316525, 0.004790431724125486, 0.004834405493645751, 0.004878197248966251, 0.0049218530005733846, 0.0049653111868711765, 0.0050086597278862, 0.00505210118857103, 0.00509539694839918, 0.0051385359299284, 0.005181523036428754, 0.0052244771313496126, 0.005267300399649765, 0.005310008769695893, 0.00535257234199861, 0.005394950352106274, 0.00543727579696859, 0.00547949551801344, 0.005521543754345943, 0.005563520348738238, 0.00560536207395374, 0.005647113888163271, 0.005688739702781784, 0.005730178943901214, 0.005771460136538853, 0.005812538651153058, 0.005853460538114904, 0.005894206353351437, 0.005934739878957605, 0.005975059468847419, 0.006015182324212697, 0.006055053282987841, 0.006094831140654324, 0.0061344240827863675, 0.006173870278189401, 0.006213317319451166, 0.0062526183131263865, 0.006291823201614872, 0.006330934603162964, 0.00637003198339236, 0.006408923694974905, 0.006447627765206723, 0.006486133460506735, 0.006524554921945257, 0.006562755165964316, 0.006600802305265726, 0.006638696097819359, 0.0066764610168483516, 0.006714077388209962, 0.006751602607162353, 0.006788934369354891, 0.006826075734979235, 0.006863108288870663, 0.006900029840832262, 0.006936782488369191, 0.006973356280330384, 0.007009768664738436, 0.0070460821223308, 0.00708221896737284, 0.007118255621546223, 0.007154158557120214, 0.007189906784126428, 0.007225571042668572, 0.007261089395321581, 0.007296526128850356, 0.007331867952266626, 0.007367086739054283, 0.007402273196723858, 0.007437354330912473, 0.007472433576353071, 0.007507441696125732, 0.00754229198744894, 0.007577071952236149, 0.007611744398244965, 0.00764630945516796, 0.007680811239002923, 0.00771523699310136, 0.007749573573265582, 0.007783708836831294, 0.007817723489043304, 0.007851531393459578, 0.007885305185292074, 0.007918901216445132, 0.00795234904499062, 0.00798574473182271, 0.00801905868641458, 0.008052282565208645, 0.008085468422200273, 0.008118628934673574, 0.008151667296529464, 0.008184672723753452, 0.008217525282851244, 0.008250341788553713, 0.008283093742668963, 0.008315825924764634, 0.008348525702931783, 0.008381166009512862, 0.008413775925569602, 0.008446303706867912, 0.00847866751548186, 0.008510865966651859, 0.008543018129038278, 0.008575110510603204, 0.008607154574018247, 0.008639104121556806, 0.008670996936918725, 0.008702790563392354, 0.008734423999108953, 0.008765994022220523, 0.008797476975718567, 0.008828888918241826, 0.008860156217876424, 0.008891334874816179, 0.008922437908309789, 0.00895349339244222, 0.00898443012031876, 0.009015288345164693, 0.00904607674993837, 0.009076817132760559, 0.00910752437507913, 0.009138135363732468, 0.009168638862552578, 0.009199096170442792, 0.009229448102638718, 0.009259694691408363, 0.0092898061391379, 0.00931989092801457, 0.009349875281384245, 0.009379737972229298, 0.009409510231222289, 0.00943920578886746, 0.009468778889985645, 0.009498240895355732, 0.009527577689752178, 0.00955684748314456, 0.009586063044347485, 0.009615205396944809, 0.009644218691468687, 0.009673146266762567, 0.009701954711911353, 0.009730691904858224, 0.009759327217117666, 0.009787860857478032, 0.009816291388966223, 0.009844616588614564, 0.009872828647211644, 0.009900935378435576, 0.00992894414545061, 0.009956910971182205, 0.009984699643632052, 0.010012360277349888, 0.010039961839209929, 0.010067521273679313, 0.010095057465770793, 0.010122498390655599, 0.010149879673751661, 0.01017716340538269, 0.010204351838560579, 0.010231490408201918, 0.010258546546191027, 0.010285543981159094, 0.010312453665713341, 0.01033931730313078, 0.01036608050584881, 0.010392736167131983, 0.010419281639028269, 0.010445765843795057, 0.010472170610365676, 0.01049843908851585, 0.010524656275703814, 0.010550806233766764, 0.010576955018759809, 0.01060300680382207, 0.01062896834700598, 0.010654812946079275, 0.010680585275289558, 0.010706347156039412, 0.010731993190116768, 0.010757617852008098, 0.010783126969085734, 0.010808517359399718, 0.010833769831422478, 0.010858960674513482, 0.01088405775255339, 0.010909049007197788, 0.010933856034913866, 0.010958555554278571, 0.01098315488600142, 0.011007699197679759, 0.011032153312809522, 0.011056500523998645, 0.0110808120392479, 0.011105040665261549, 0.011129234196682368, 0.011153319016608612, 0.011177309173665488, 0.011201170412419059, 0.011224947682965688, 0.011248703841430233, 0.011272387680975379, 0.011295882619920755, 0.011319306156816216, 0.011342625200044091, 0.011365882190454745, 0.011389028863160146, 0.011412105554145784, 0.011435202121097072, 0.011458245500039297, 0.011481104054852911, 0.011503987435826452, 0.011526713029093387, 0.011549364936919288, 0.011571932342241163, 0.011594358502833284, 0.011616658570527757, 0.011638903899811724, 0.011661068095024957, 0.011683101673534261, 0.011704954763903003, 0.011726706173246323, 0.011748439523081453, 0.011770141968816783, 0.011791684038910302, 0.011813077073668922, 0.01183433592916538, 0.011855511101495814, 0.011876563853805805, 0.011897594633122843, 0.01191844345050786, 0.01193918234397072, 0.011959956651960308, 0.011980636986583344, 0.012001284900534473, 0.012021881535558955, 0.012042253787178412, 0.01206250952353217, 0.012082716496373101, 0.01210277573379878, 0.012122728647670066, 0.012142599537728352, 0.01216252703085279, 0.012182108405835744, 0.0122015113326532, 0.012220756795649528, 0.012240014014668971, 0.01225901009622531, 0.012277604278147747, 0.012296184020534735, 0.012314711021565578, 0.012333252539886142, 0.012351542611848496, 0.01236955027027622, 0.01238755859595093, 0.012405252669842819, 0.012422729213880164, 0.012440105209521782, 0.01245742663046236, 0.012474737177215353, 0.01249214451186149, 0.01250978016155833, 0.01252620255377533, 0.012542367073894395, 0.01255832969738531, 0.01257380462237975, 0.012588962703794206, 0.012603569486284804, 0.01261778110208728, 0.012630949423612488, 0.012644025295070598, 0.012657198735940896, 0.012670227126655269, 0.012681646923915364, 0.012691619474331946, 0.012701573537728961]
n = len(steps)
time = np.arange(0,n)

# Regression 
popt, pcov = curve_fit(func, time, steps)
x_plot=np.linspace(0,n,500)

# Equation
a=popt[0].round(6)
b=popt[1].round(6)
c=popt[2].round(6)
eqn = f'y={a}e^({b}x)+{c}'
print(f'The equation of regression line is y={a}e^({b}x)+{c}')

plt.scatter(time, steps)
plt.plot(x_plot, func(x_plot, *popt), 'r-')
plt.title("Change in Height of Liquid Front in Segment Case Time Simulation")
plt.ylabel("Change in Position of Liquid Front (m)")
plt.xlabel("Time Step")
plt.legend([eqn, "Change in Height"])
plt.show()
